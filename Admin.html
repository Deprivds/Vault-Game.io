<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Constellation Cipher Admin</title>

  <!-- üé® CSS STYLES -->
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #111;
      color: white;
      text-align: center;
      margin: 0;
      padding: 0;
    }

    h1 { 
      color: #ffd700; 
      padding: 20px; 
    }

    label { 
      display: block; 
      margin: 15px; 
    }

    input, select {
      padding: 10px;
      border-radius: 5px;
      border: none;
      font-size: 16px;
      margin-top: 5px;
    }

    button {
      margin: 20px;
      padding: 10px 20px;
      border-radius: 5px;
      border: none;
      background: #ffd700;
      font-size: 16px;
      cursor: pointer;
    }

    .answers {
      margin-top: 20px;
      font-size: 18px;
    }

    .answers span {
      display: block;
      margin: 5px 0;
      color: #00ffcc;
    }
  </style>
</head>
<body>

  <!-- üõ†Ô∏è ADMIN HEADER -->
  <h1>‚öôÔ∏è Admin Settings</h1>
  
  <!-- üî≠ CONSTELLATION DROPDOWN -->
  <label>
    Choose Constellation:
    <select id="starSelect"></select>
  </label>

  <!-- üìù ANSWERS PREVIEW -->
  <div class="answers">
    <span id="cwAnswer">Clockwise: ‚Äî</span>
    <span id="ccwAnswer">Counterclockwise: ‚Äî</span>
  </div>

  <!-- üîò ACTION BUTTONS -->
  <button onclick="saveSettings()">Save Settings</button>
  <button onclick="goBack()">‚¨ÖÔ∏è Back to Game</button>


  <!-- ‚öôÔ∏è SCRIPT SECTION -->
  <script>
    // ============================================================
    // 1. CONSTELLATION STAR COUNTS
    // ============================================================
    const constellations = {
      "Aries": 5,
      "Taurus": 11,
      "Gemini": 8,
      "Cancer": 5,
      "Leo": 9,
      "Virgo": 9,
      "Libra": 8,
      "Scorpio": 14,
      "Sagittarius": 20,
      "Capricorn": 9,
      "Aquarius": 11,
      "Pisces": 20
    };

    // ============================================================
    // 2. CAESAR CIPHER FUNCTION
    // ============================================================
    function caesarShift(str, shift) {
      return str.split("").map(char => {
        if (/[a-z]/.test(char)) { 
          let code = char.charCodeAt(0) - 97;
          return String.fromCharCode(((code + shift + 26) % 26) + 97);
        } else if (/[A-Z]/.test(char)) { 
          let code = char.charCodeAt(0) - 65;
          return String.fromCharCode(((code + shift + 26) % 26) + 65);
        }
        return char;
      }).join("");
    }

    // ============================================================
    // 3. POPULATE DROPDOWN WITH CONSTELLATIONS
    // ============================================================
    const sel = document.getElementById("starSelect");
    Object.keys(constellations).forEach(c => {
      const opt = document.createElement("option");
      opt.value = c;
      opt.textContent = c;
      sel.appendChild(opt);
    });

    // ============================================================
    // 4. UPDATE ANSWERS DISPLAY
    // ============================================================
    function updateAnswers(constellation) {
      let starCount = constellations[constellation];
      let baseWord = constellation;

      let cw = caesarShift(baseWord, starCount);
      let ccw = caesarShift(baseWord, -starCount);

      document.getElementById("cwAnswer").textContent = "Clockwise: " + cw;
      document.getElementById("ccwAnswer").textContent = "Counterclockwise: " + ccw;

      return { cw, ccw };
    }

    // ============================================================
    // 5. AUTO-UPDATE WHEN CONSTELLATION IS PICKED
    // ============================================================
    sel.addEventListener("change", function() {
      updateAnswers(this.value);
    });

    // ============================================================
    // 6. SAVE SETTINGS (STORE CONSTELLATION + ANSWERS)
    // ============================================================
    function saveSettings() {
      const star = document.getElementById("starSelect").value;
      const { cw, ccw } = updateAnswers(star);

      localStorage.setItem("cipherStar", star);
      localStorage.setItem("cipherAnswerCW", cw);
      localStorage.setItem("cipherAnswerCCW", ccw);

      alert("‚úÖ Settings saved!\nConstellation: " + star + 
            "\nClockwise Answer: " + cw + 
            "\nCounterclockwise Answer: " + ccw);
    }

    // ============================================================
    // 7. LOAD PREVIOUS SETTINGS
    // ============================================================
    window.onload = function() {
      let savedStar = localStorage.getItem("cipherStar");
      if (savedStar) {
        sel.value = savedStar;
        const { cw, ccw } = updateAnswers(savedStar);
        // üîπ Force update to match current constellationCounts numbers
        localStorage.setItem("cipherAnswerCW", cw);
        localStorage.setItem("cipherAnswerCCW", ccw);
      }
    }


    // ============================================================
    // 8. BACK TO MAIN GAME
    // ============================================================
    function goBack() {
      localStorage.setItem("backFromAdmin", "true");
      window.location.href = "index.html";
    }
  </script>

</body>
</html>